# Burn2Cool v4.1 ‚Äî 2025-12-20

## üî• Highlights

- **HWMon preferred**: The system now prefers HWMon sensors where available; thermal zones are used as a fallback.
- **New API & UI control for sensor selection**: persistent `sensor-source` and `sensor` settings (Auto / HWMon / Thermal).
- **Improved UI for excludes & status**: unified excludes modal, excluded entries are shown disabled/greyed out.

---

## ‚ú® Features

- Runtime detection and automatic switch to available HWMon sensors when in `auto` mode.
- New endpoint: `GET /api/hwmons` (returns available hwmon devices and sensors, temperatures and `excluded` flags).
- `GET /api/status` now includes **sensor**, **effective_sensor**, and **sensor_source** (so the UI can display the currently used sensor).
- Settings API: `POST /api/settings/sensor-source` (`auto|hwmon|thermal`) and `POST /api/settings/sensor` (path or `auto`).
- `POST /api/settings/excluded-types` accepts `clear` to reset excludes.

---

## üé® UI / UX Improvements

- Sensor Source and Device selects moved into the **Settings** panel for a consistent layout.
- **Excludes modal**: unified card-style groups for HWMon and thermal entries, improved spacing, hover feedback, and scrollbars contained inside rounded containers.
- **Status card**: sensor displayed compactly inline after the label; long sysfs paths are shortened for display (CSS adds the visible `...`) while the full path is available in the tooltip.
- Responsive behavior:
  - Sensor line wraps at **‚â§ 560px** to avoid layout breaks.
  - Skins FAB collapses into a compact stacked layout at **‚â§ 950px**.
  - Device/Source selects are responsive and synchronize widths with special handling in the **480‚Äì560px** range.
- Small UI fixes: round close button in modals, consistent gear-button size, AVG button stability on narrow viewports.

---

## üêû Bug Fixes

- Excluded sensors are disabled in selects (disabled + greyed out).
- Misc JS/CSS fixes in modal and status rendering.

---

## üõ†Ô∏è Developer Notes

- Configuration file remains compatible; settings persist (e.g. `sensor-source`, `excluded-types`).
- Outstanding item: several snprintf truncation warnings remain in `cpu_throttle.c`; a tidy-up of buffer sizing is recommended.

---

## ‚öôÔ∏è Upgrade Notes

- Rebuild and restart the daemon (example: `sudo pkill -f cpu_throttle || true && sudo ./cpu_throttle --web-port <port> &`).
- Recommendation: stop any stale daemon instances before starting the new one.

---